<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;light&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/images/favicon.png"><link rel="icon" href="/images/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="选用了MagicMirror2的插件 MMM-WeeklySchedule 来实现课程表功能，并对其增加显示上课地点的feature。"><meta name="author" content="Vlist"><meta name="keywords" content=""><title>为MMM-WeeklySchedule添加地点详情功能 - Vlist&#39;s Blog</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"vlist.gitee.io",root:"/",version:"1.8.8",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,onlypost:!1},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Vlist's Blog</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(https://bing.biturl.top/?resolution=1920&format=image&index=0&mkt=zh-CN) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="为MMM-WeeklySchedule添加地点详情功能"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-03-08 09:23" pubdate>2021年3月8日 上午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.7k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 32 分钟</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">为MMM-WeeklySchedule添加地点详情功能</h1><div class="markdown-body"><h2 id="0-背景"><a href="#0-背景" class="headerlink" title="0. 背景"></a>0. 背景</h2><h3 id="0-1-关于我的项目"><a href="#0-1-关于我的项目" class="headerlink" title="0.1 关于我的项目"></a>0.1 关于我的项目</h3><p>使用 <a herf="https://github.com/MichMich/MagicMirror">MagicMirror<sup>2</sup></a> 可以搭建一个基于NodeJS和JavaScript的展示屏幕。</p><p>在本校的计算机应用大赛中，本小组制作了基于树莓派的物联网智能仪容镜，能够在单向玻璃后使用一块常规的IPS屏幕来显示内容。</p><p>其中内容的展示我们选用了基于NodeJS和JavaScript的MagicMirror<sup>2</sup>来展示所需要显示的内容。</p><p>由于我们的项目针对学生的需求，希望能够加入展示课程表的功能，所以我们选用了MagicMirror<sup>2</sup>的插件 <strong>MMM-WeeklySchedule</strong> 来实现课程表功能，并对其增加显示上课地点的feature。</p><h3 id="0-2-关于MagicMirror-2"><a href="#0-2-关于MagicMirror-2" class="headerlink" title="0.2 关于MagicMirror 2"></a>0.2 关于MagicMirror <sup>2</sup></h3><p><img src="https://gitee.com/yqlai/MagicMirror/raw/master/.github/header.png" srcset="/img/loading.gif" alt="MagicMirror²: The open source modular smart mirror platform. "></p><blockquote><p><strong>MagicMirror²</strong> is an open source modular smart mirror platform. With a growing list of installable modules, the <strong>MagicMirror²</strong> allows you to convert your hallway or bathroom mirror into your personal assistant. <strong>MagicMirror²</strong> is built by the creator of <a target="_blank" rel="noopener" href="https://michaelteeuw.nl/tagged/magicmirror">the original MagicMirror</a> with the incredible help of a <a target="_blank" rel="noopener" href="https://github.com/MichMich/MagicMirror/graphs/contributors">growing community of contributors</a>.</p></blockquote><h3 id="0-3-关于MMM-WeeklySchedule"><a href="#0-3-关于MMM-WeeklySchedule" class="headerlink" title="0.3 关于MMM-WeeklySchedule"></a>0.3 关于MMM-WeeklySchedule</h3><p>以下是关于本项目的介绍，本项目是一个MagicMirror的插件，能够在MagicMirror页面上根据配置文件按星期显示课程表，课程表包含了上课时间和课程名称。</p><p><a target="_blank" rel="noopener" href="https://github.com/pinsdorf/MMM-WeeklySchedule">项目地址</a></p><h4 id="MMM-WeeklySchedule"><a href="#MMM-WeeklySchedule" class="headerlink" title="MMM-WeeklySchedule"></a>MMM-WeeklySchedule</h4><p>This a module for the <a target="_blank" rel="noopener" href="https://github.com/MichMich/MagicMirror">MagicMirror</a>. It displays today’s timetable from a weekly recurring schedule. It is intended for regular weekly schedules, which have a low update frequency and thus can be maintained manually. Examples are:</p><ul><li>kid’s school classes</li><li>student lectures</li><li>teacher’s teaching schedule</li><li>gym training classes</li><li>household chores</li><li>opening hours of bakery, post office, supermarket</li></ul><img src="/2021/03/MMM-weeklyschedule-add-feature/screenshot2.png" srcset="/img/loading.gif" alt="preview" style="zoom:50%"><h4 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h4><p>The entry in <code>config.js</code> can include the following options:</p><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td><code>schedule</code></td><td>Defines the data the module shows. It consists of a definition for <code>timeslots</code> and <code>lessons</code>. See below.</td></tr><tr><td><code>updateInterval</code></td><td>How often the content is updated. <strong>Default value:</strong> <code>1 • 60 • 60 • 1000</code> // every 1 hour</td></tr><tr><td><code>showWeekdayinHeader</code></td><td>Appends the module <code>header</code>text with weekday name, e.g., <em>on Monday</em> <strong>Default value:</strong> <code>true</code></td></tr><tr><td><code>showNextDayAfter</code></td><td>From this time of the day on the module shows the schedule of the <em>next</em> day. This is helpful when, e.g., a school day is over and you want to show what is up tomorrow. If you don’t like this set the value to <code>23:59</code> or <code>undefined</code>. <strong>Default value:</strong> <code>16:00</code></td></tr><tr><td><code>allowHTML</code></td><td>Whether timeslot and lesson texts can contain HTML. Can for example be used to color certain lessons. <strong>Default value:</strong> <code>false</code></td></tr></tbody></table><h2 id="1-项目需求分析"><a href="#1-项目需求分析" class="headerlink" title="1. 项目需求分析"></a>1. 项目需求分析</h2><p>经过了简单的了解，MMM-WeeklySchedule只能够按照星期显示上课的时间的课程名称，不能够显示上课的地点。</p><p>然而我们所设计的项目中需要本模块能够显示上课地点，所以对MMM-WeeklySchedule进行更改，添加显示上课地点的feature</p><h2 id="2-代码修改"><a href="#2-代码修改" class="headerlink" title="2. 代码修改"></a>2. 代码修改</h2><h3 id="2-1-项目代码分析"><a href="#2-1-项目代码分析" class="headerlink" title="2.1 项目代码分析"></a>2.1 项目代码分析</h3><p>项目文件的树状结构</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css">├── <span class="hljs-selector-tag">MMM-WeeklySchedule</span><span class="hljs-selector-class">.css</span><br>├── <span class="hljs-selector-tag">MMM-WeeklySchedule</span><span class="hljs-selector-class">.js</span><br>├── <span class="hljs-selector-tag">package</span><span class="hljs-selector-class">.json</span><br>├── <span class="hljs-selector-tag">README</span><span class="hljs-selector-class">.md</span><br>└── <span class="hljs-selector-tag">translations</span><br>    ├── <span class="hljs-selector-tag">en</span><span class="hljs-selector-class">.json</span><br>    ├── ...<br>    └── <span class="hljs-selector-tag">zh-cn</span><span class="hljs-selector-class">.json</span><br></code></pre></td></tr></table></figure><p>简单分析可以知道，<code>MMM-WeeklySchedule.css</code> 和 <code>MMM-WeeklySchedule.js</code> 是本项目最核心的文件，涉及到课程表HTML表单的生成，</p><p><code>package.json</code> 是NodeJS的npm管理器相关的包管理文件，</p><p><code>README.md</code> 是本项目的说明文件，</p><p><code>translations/</code> 其中存放了本项目的i18n文件。</p><hr><p>分析 <code>MMM-WeeklySchedule.js</code> ，其中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-comment">//Other function ...</span><br>    <br>	getDom: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>		<span class="hljs-keyword">var</span> date = <span class="hljs-built_in">this</span>.getDisplayDate(); <br><br>		<span class="hljs-comment">// get day of week and access respective element in lessons array</span><br>		<span class="hljs-keyword">var</span> dow = date.locale(<span class="hljs-string">&#x27;en&#x27;</span>).format(<span class="hljs-string">&quot;ddd&quot;</span>).toLowerCase();<br>		<span class="hljs-keyword">var</span> lessons = <span class="hljs-built_in">this</span>.config.schedule.lessons[dow];<br><br>		<span class="hljs-comment">// no lessons today, we return default text</span><br>		<span class="hljs-keyword">if</span>(lessons == <span class="hljs-literal">undefined</span>)<br>		&#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.createTextOnlyDom(<br>				<span class="hljs-built_in">this</span>.translate(<span class="hljs-string">&quot;NO_LESSONS&quot;</span>)<br>			);<br>		&#125;<br><br>		<span class="hljs-comment">// get timeslots</span><br>		<span class="hljs-keyword">var</span> timeslots = <span class="hljs-built_in">this</span>.config.schedule.timeslots;<br><br>		<span class="hljs-comment">// build table with timeslot definitions and lessons</span><br>		wrapper = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;table&quot;</span>);<br>		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; lessons.length; index++) &#123;<br>			<span class="hljs-keyword">const</span> lesson = lessons[index];<br>			<span class="hljs-keyword">const</span> time = timeslots[index];<br><br>			<span class="hljs-comment">// only create a row if the timeslot&#x27;s lesson is defined and not an empty string</span><br>			<span class="hljs-keyword">if</span>(lesson)<br>			&#123;<br>				<span class="hljs-keyword">var</span> row = <span class="hljs-built_in">this</span>.createTimetableRow(time, lesson); <br>				wrapper.appendChild(row);<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> wrapper;<br>        <span class="hljs-comment">//Other function ...</span><br>	&#125;,<br></code></pre></td></tr></table></figure><p>可以知道，<code>getDom: function()</code> 是关系着DOM生成的函数，在此处生成了将要显示在 <code>MagicMirror</code> 展示屏幕上的内容 。</p><p>在 <code>getDom: function()</code> 中，可以知道涉及到生成基于表格的课程表的部分代码在此处：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// build table with timeslot definitions and lessons</span><br>wrapper = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;table&quot;</span>);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; lessons.length; index++) &#123;<br>	<span class="hljs-keyword">const</span> lesson = lessons[index];<br>	<span class="hljs-keyword">const</span> time = timeslots[index];<br></code></pre></td></tr></table></figure><p>所以我们需要修改的部分主要在此处。</p><h3 id="2-2-代码修改"><a href="#2-2-代码修改" class="headerlink" title="2.2 代码修改"></a>2.2 代码修改</h3><h4 id="2-2-1-读取课程"><a href="#2-2-1-读取课程" class="headerlink" title="2.2.1 读取课程"></a>2.2.1 读取课程</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>    <span class="hljs-built_in">module</span>: <span class="hljs-string">&quot;MMM-WeeklySchedule&quot;</span>,<br>    position: <span class="hljs-string">&quot;top_left&quot;</span>,<br>    header: <span class="hljs-string">&quot;Household chores&quot;</span>,<br>    config: &#123;<br>            schedule: &#123;<br>                    timeslots: [ <span class="hljs-string">&quot;Feed the fish&quot;</span>, <span class="hljs-string">&quot;Set the table&quot;</span>, <span class="hljs-string">&quot;Take out the trash&quot;</span>, <span class="hljs-string">&quot;Hoover living room&quot;</span> ],<br>                    lessons: &#123;<br>                            mon: [ <span class="hljs-string">&quot;Bart&quot;</span>,  <span class="hljs-string">&quot;Marge&quot;</span>, <span class="hljs-string">&quot;Homer&quot;</span>, <span class="hljs-string">&quot;Lisa&quot;</span>  ],<br>                            tue: [ <span class="hljs-string">&quot;Lisa&quot;</span>,  <span class="hljs-string">&quot;Bart&quot;</span>,  <span class="hljs-string">&quot;Marge&quot;</span>, <span class="hljs-string">&quot;Homer&quot;</span> ],<br>                            wed: [ <span class="hljs-string">&quot;Homer&quot;</span>, <span class="hljs-string">&quot;Lisa&quot;</span>,  <span class="hljs-string">&quot;Bart&quot;</span>,  <span class="hljs-string">&quot;Marge&quot;</span> ],<br>                            thu: [ <span class="hljs-string">&quot;Marge&quot;</span>, <span class="hljs-string">&quot;Homer&quot;</span>, <span class="hljs-string">&quot;Lisa&quot;</span>,  <span class="hljs-string">&quot;Bart&quot;</span>  ],<br>                            fri: [ <span class="hljs-string">&quot;Bart&quot;</span>,  <span class="hljs-string">&quot;Marge&quot;</span>, <span class="hljs-string">&quot;Homer&quot;</span>, <span class="hljs-string">&quot;Lisa&quot;</span> ]<br>                    &#125;<br>            &#125;,<br>            updateInterval: <span class="hljs-number">1</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// every hour</span><br>            showNextDayAfter: <span class="hljs-literal">undefined</span><br>    &#125;<br>&#125;,<br></code></pre></td></tr></table></figure><p>这是原模块设计的配置文件部分，其中 <code>schedule</code> 字段规定了模块所显示的课程表信息，我们的计划是在每个课程中添加字段，使用 <code>name</code> 字段来表示课程名称，使用 <code>room</code> 来表示上课地点。</p><p>根据MagicMirror的 <code>说明文档</code> <a target="_blank" rel="noopener" href="https://docs.magicmirror.builders/">Introduction | MagicMirror² Documentation</a></p><p>使用 <code>this.config</code> 可以在模块的js文件中引用 <code>config.js</code> 文件中的本模块部分的配置。</p><p>在 <code>getDom: function()</code> 中，使用了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> lessons = <span class="hljs-built_in">this</span>.config.schedule.lessons[dow];<br></code></pre></td></tr></table></figure><p>来对配置文件进行读取，生成了lessons对象。</p><p>对其加以修改</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; lessons.length; index++) &#123;<br>	<span class="hljs-keyword">const</span> lesson = lessons[index][<span class="hljs-string">&quot;name&quot;</span>];<br>	<span class="hljs-keyword">const</span> room = lessons[index][<span class="hljs-string">&quot;room&quot;</span>];<br>	<span class="hljs-keyword">const</span> time = timeslots[index];<br><br>	<span class="hljs-keyword">var</span> row = <span class="hljs-built_in">this</span>.createTimetableRow(time, lesson, room);<br>	wrapper.appendChild(row);<br>&#125;<br></code></pre></td></tr></table></figure><p>如上述修改即可对配置文件中的内容进行读取了。修改后的配置文件应以如下方法使用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript">lessons: &#123;<br>	mon: [<br>		&#123;<br>			name: <span class="hljs-string">&quot;&quot;</span>,<br>			room: <span class="hljs-string">&quot;&quot;</span>,<br>		&#125;,<br>		&#123;<br>			name: <span class="hljs-string">&quot;软件工程导论&quot;</span>,<br>			room: <span class="hljs-string">&quot;1107&quot;</span>,<br>		&#125;,<br>		&#123;<br>			name: <span class="hljs-string">&quot;离散数学&quot;</span>,<br>			room: <span class="hljs-string">&quot;3110&quot;</span>,<br>		&#125;,<br>		&#123;<br>			name: <span class="hljs-string">&quot;大学生体育与健康&quot;</span>,<br>			room: <span class="hljs-string">&quot;西看台202&quot;</span>,<br>		&#125;,<br>		&#123;<br>			name: <span class="hljs-string">&quot;&quot;</span>,<br>			room: <span class="hljs-string">&quot;&quot;</span>,<br>		&#125;<br>	],<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-2-设置样式"><a href="#2-2-2-设置样式" class="headerlink" title="2.2.2 设置样式"></a>2.2.2 设置样式</h4><p>完成了从配置文件读取内容的部分，还需要对读取的内容进行Html样式的设计。</p><p>分析原项目的 <code>MMM-WeeklySchedule.js</code> 可以发现和设置样式有关的函数</p><p><code>createTimetableRow: function (time, lesson)</code></p><p>与设置单元格样式有关的部分：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> tdlesson = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;td&quot;</span>);<br>tdlesson.className = <span class="hljs-string">&quot;xsmall bright lesson&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.config.allowHTML) &#123;<br>	tdlesson.innerHTML = lesson;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>	tdlesson.appendChild(<br>		<span class="hljs-built_in">document</span>.createTextNode(lesson)<br>	);<br>&#125;<br>row.appendChild(tdlesson);<br></code></pre></td></tr></table></figure><p>依照原本的函数，可以添加对新增内容 <code>room</code> 的设置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> tdroom = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&quot;td&quot;</span>);<br>tdroom.className = <span class="hljs-string">&quot;xsmall bright lesson&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.config.allowHTML) &#123;<br>	tdroom.innerHTML = room;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>	tdroom.appendChild(<br>		<span class="hljs-built_in">document</span>.createTextNode(room)<br>	);<br>&#125;<br>row.appendChild(tdroom);<br></code></pre></td></tr></table></figure><h3 id="2-3-CSS修改"><a href="#2-3-CSS修改" class="headerlink" title="2.3 CSS修改"></a>2.3 CSS修改</h3><p>由于原本的模块基于英文进行的开发，此处如果有需要可以在CSS文件中对中文样式进行调整</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs css">&#123;<br>.lessontime &#123;<br>    <span class="hljs-selector-tag">text-align</span>: <span class="hljs-selector-tag">right</span>;<br>    <span class="hljs-selector-tag">white-space</span>: <span class="hljs-selector-tag">nowrap</span>;<br>    <span class="hljs-selector-tag">padding-right</span>: 2<span class="hljs-selector-tag">em</span>;<br>    <span class="hljs-selector-tag">width</span>: 1<span class="hljs-selector-tag">ex</span>;<br>&#125;<br><br><span class="hljs-selector-class">.lesson</span>&#123;<br>    <span class="hljs-attribute">text-align</span>: left;<br>    <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">1em</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-成果展示"><a href="#3-成果展示" class="headerlink" title="3. 成果展示"></a>3. 成果展示</h2><p><img src="/2021/03/MMM-weeklyschedule-add-feature/Screenshot3.png" srcset="/img/loading.gif" alt="preview"></p><h2 id="4-结语"><a href="#4-结语" class="headerlink" title="4. 结语"></a>4. 结语</h2><p>本项目是基于MagicMirror的一个插件，使用JavaScript来编写，也可以使用Html语法来进行修改。</p><p>原本是用于制作“魔镜”的插件，在针对本地化的过程中加入了针对中国大学生看课表时也需要注意上课时间的特点，增添了课程上课地点的展示。</p><p>总的来说效果令人满意。</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B8%8E%E5%88%9B%E6%96%B0/">软件开发与创新</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/JavaScript/">JavaScript</a> <a class="hover-with-bg" href="/tags/NodeJS/">NodeJS</a> <a class="hover-with-bg" href="/tags/%E4%BD%9C%E4%B8%9A/">作业</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2021/04/Pair-Programing/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Pair Programing 结对编程初体验</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2021/03/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B8%8E%E5%88%9B%E6%96%B0-%E5%8D%9A%E5%AE%A2%E6%B5%8B%E8%AF%95/"><span class="hidden-mobile">软件开发与创新-博客测试</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div id="vcomments"></div><script type="text/javascript">Fluid.utils.waitElementVisible("vcomments",(function(){Fluid.utils.createScript("https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js",(function(){new Valine({el:"#vcomments",app_id:"P0S0As2s6zKSkCQ4s0zGEuIx-gzGzoHsz",app_key:"MikME4wzroydcSoh25JUkWL1",placeholder:"说点什么",path:window.location.pathname,avatar:"retro",meta:["nick","mail","link"],pageSize:"10",lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"https://p0s0as2s.lc-cn-n1-shared.com"})}))}))</script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a></noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/js/local-search.js"></script><script>$("#local-search-input").on("click",(function(){searchFunc("/local-search.xml","local-search-input","local-search-result")})),$("#modalSearch").on("shown.bs.modal",(function(){$("#local-search-input").focus()}))</script><script src="/js/boot.js"></script></body></html>